<!DOCTYPE html>
<html>
    <head>
        <title>Game</title>

        <link rel="stylesheet" href="assets/main.css">

        <!-- Main Script -->
        <script src="game.js" type="text/javascript"></script>

        <!-- Vendors -->
        <script src="vendor/prototype.js"></script>
        <script src="vendor/three.min.js"></script>

        <!-- Commands -->
        <script src="command/CommandQueue.js"></script>
        <script src="command/WalkCommand.js"></script>

        <!-- Controllers -->
        <script src="controller/MainMenuController.js"></script>

        <!-- Models -->
        <script src="model/Entity.js"></script>
        <script src="model/Player.js"></script>

        <script src="menu.js" type="text/javascript"></script>
        <script src="overworld.js" type="text/javascript"></script>
        <script src="player.js" type="text/javascript"></script>
    </head>
    <body>
        <div id="wrapper">
            <div id="game">
                <canvas id="jgame" width="600" height="400" tabindex="1"></canvas>
            </div>
        </div>

        <script type="text/javascript">

            G.setupIO();
            G.initialize();

            G.run = (function() {
                var loops = 0, skipTicks = 1000 / G.fps,
                        maxFrameSkip = 10,
                        nextGameTick = (new Date).getTime();

                return function() {
                    loops = 0;

                    while ((new Date).getTime() > nextGameTick) {

                        G.update();
                        nextGameTick += skipTicks;
                        loops++;
                    }

                    G.draw();
                };
            })();

            (function() {
                var onEachFrame;
                if (window.webkitRequestAnimationFrame) {
                    onEachFrame = function(cb) {
                        var _cb = function() {
                            cb();
                            webkitRequestAnimationFrame(_cb);
                        }
                        _cb();
                    };
                } else if (window.mozRequestAnimationFrame) {
                    onEachFrame = function(cb) {
                        var _cb = function() {
                            cb();
                            mozRequestAnimationFrame(_cb);
                        }
                        _cb();
                    };
                } else {
                    onEachFrame = function(cb) {
                        setInterval(cb, 1000 / 60);
                    }
                }

                window.onEachFrame = onEachFrame;
            })();

            window.onEachFrame(G.run);
        </script>
    </body>
</html>